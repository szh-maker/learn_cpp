# static_assert 声明（C++11 C++17）

## 19.1 运行时断言

在静态断言出现以前，我们使用的是运行时断言，只有程序运行起来之后才有可能触发它。通常情况下运行时断言只会在 Debug 模式下使用，因为断言的行为比较粗暴，它会直接显示错误信息并终止程序。在 Release 版本中，通常会忽略断言（头文件 cassert 已经通过宏 NDEBUG 对 Debug 和 Release 版本做了区分处理，我们可以直接使用assert）。还有一点需要注意，断言不能替代程序员中的错误检查，它只应该出现需要表达式返回 true 的位置。

## 19.2 静态断言的需求

虽然运行时断言可以满足一部分需求，但是在模板实例化时对模板实参进行约束，运行时断言是做不到的。

## 19.3 静态断言

static_assert 声明是 C++11 标准引入的特性，用于在程序编译阶段评估常量表达式并返回 false 的表达式断言，称这种方式为静态断言。

基本满足对静态断言的要求：

1. 所有处理必须在编译期间执行，不允许有空间上的运行成本。
2. 它必须有简单的语法。
3. 断言失败可以显示丰富的错误诊断信息。
4. 它可以在命名空间、类或代码块内使用。
5. 失败的断言会在编译期报错。

C++11 标准规定，使用 static_assert 需要传入两个实参：常量表达式和诊断消息字符串。请注意第一个实参必须是常量表达式，因为编译器无法计算出运行时才能确定结果的表达式。

## 19.4 单参数 static_assert

在大多数情况下使用 static_assert的时候输入的诊断信息字符串就是常量表达式本身，所以让常量表达式作为诊断信息字符串参数的默认值是非常理想的。C++17 已经支持。

